---
import { SEO } from 'astro-seo';

interface Props {
  title?: string;
  description?: string;
  image?: string;
  canonicalUrl?: string;
  noindex?: boolean;
  structuredData?: object | object[];
  keywords?: string[];
  article?: boolean;
  publishDate?: string;
  modifiedDate?: string;
  author?: string;
  section?: string;
}

const { 
  title = "OpenOrbit | Award-Winning Software Development Agency",
  description = "OpenOrbit: Premium software development agency delivering web apps, mobile apps, cloud solutions & AI integration. 150+ successful projects, 98% client satisfaction. Enterprise-grade solutions for startups to Fortune 500.",
  image = "https://openorbit.io/og-image.jpg",
  canonicalUrl = Astro.url.href,
  noindex = false,
  structuredData = [],
  keywords = [],
  article = false,
  publishDate,
  modifiedDate,
  author = "OpenOrbit",
  section = "Technology"
} = Astro.props;

const siteUrl = "https://openorbit.io";
const siteName = "OpenOrbit";

const defaultKeywords = [
  "software development agency",
  "custom software development",
  "web application development",
  "mobile app development",
  "enterprise software solutions",
  "cloud solutions",
  "AI integration",
  "machine learning development",
  "blockchain development",
  "IoT solutions",
  "digital transformation",
  "SaaS development",
  "MVP development",
  "React development",
  "Next.js development",
  "Node.js development",
  "full stack development",
  "API development",
  "DevOps services",
  "UI UX design",
  "software consulting",
  "agile development",
  "custom web development",
  "mobile development company",
  "app development agency",
  "software engineering services"
];

const allKeywords = [...defaultKeywords, ...keywords].join(", ");

// Comprehensive Organization Schema
const organizationSchema = {
  "@context": "https://schema.org",
  "@type": "Organization",
  "@id": `${siteUrl}/#organization`,
  "name": siteName,
  "alternateName": "OpenOrbit Software Development",
  "url": siteUrl,
  "logo": {
    "@type": "ImageObject",
    "url": `${siteUrl}/logo.png`,
    "width": 512,
    "height": 512,
    "caption": "OpenOrbit Logo"
  },
  "image": {
    "@type": "ImageObject",
    "url": image,
    "width": 1200,
    "height": 630
  },
  "description": description,
  "foundingDate": "2012",
  "founders": [
    {
      "@type": "Person",
      "name": "OpenOrbit Team"
    }
  ],
  "address": {
    "@type": "PostalAddress",
    "addressCountry": "US",
    "addressLocality": "San Francisco",
    "addressRegion": "CA"
  },
  "contactPoint": [
    {
      "@type": "ContactPoint",
      "contactType": "sales",
      "email": "hello@openorbit.io",
      "availableLanguage": ["English"],
      "contactOption": "TollFree",
      "areaServed": "Worldwide"
    },
    {
      "@type": "ContactPoint",
      "contactType": "technical support",
      "email": "support@openorbit.io",
      "availableLanguage": ["English"]
    }
  ],
  "sameAs": [
    "https://twitter.com/openorbit",
    "https://linkedin.com/company/openorbit",
    "https://github.com/openorbit",
    "https://facebook.com/openorbit",
    "https://instagram.com/openorbit",
    "https://www.crunchbase.com/organization/openorbit"
  ],
  "hasOfferCatalog": {
    "@type": "OfferCatalog",
    "name": "Software Development Services",
    "itemListElement": [
      {
        "@type": "Offer",
        "itemOffered": {
          "@type": "Service",
          "name": "Web Application Development",
          "description": "Custom web applications built with React, Next.js, and modern frameworks"
        }
      },
      {
        "@type": "Offer",
        "itemOffered": {
          "@type": "Service",
          "name": "Mobile App Development",
          "description": "Native iOS, Android, and cross-platform React Native apps"
        }
      },
      {
        "@type": "Offer",
        "itemOffered": {
          "@type": "Service",
          "name": "Cloud Solutions",
          "description": "AWS, GCP, Azure cloud architecture and DevOps services"
        }
      },
      {
        "@type": "Offer",
        "itemOffered": {
          "@type": "Service",
          "name": "AI & Machine Learning",
          "description": "Custom AI solutions, ML models, and intelligent automation"
        }
      }
    ]
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "4.9",
    "reviewCount": "150",
    "bestRating": "5",
    "worstRating": "1"
  },
  "makesOffer": [
    {
      "@type": "Offer",
      "name": "Free Technical Consultation",
      "description": "Complimentary 30-minute technical consultation for new projects"
    }
  ]
};

// Local Business Schema with detailed info
const localBusinessSchema = {
  "@context": "https://schema.org",
  "@type": "ProfessionalService",
  "@id": `${siteUrl}/#localbusiness`,
  "name": `${siteName} - Software Development Agency`,
  "image": image,
  "url": siteUrl,
  "telephone": "+1-415-555-0123",
  "email": "hello@openorbit.io",
  "priceRange": "$$$",
  "currenciesAccepted": "USD, EUR, GBP",
  "paymentAccepted": "Credit Card, Wire Transfer, Cryptocurrency",
  "openingHoursSpecification": [
    {
      "@type": "OpeningHoursSpecification",
      "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
      "opens": "09:00",
      "closes": "18:00",
      "timeZone": "America/Los_Angeles"
    }
  ],
  "areaServed": [
    {
      "@type": "Place",
      "name": "Global"
    },
    {
      "@type": "Country",
      "name": ["United States", "Canada", "United Kingdom", "Europe", "Australia"]
    }
  ],
  "serviceArea": {
    "@type": "GeoCircle",
    "geoMidpoint": {
      "@type": "GeoCoordinates",
      "latitude": "37.7749",
      "longitude": "-122.4194"
    },
    "geoRadius": "50000",
    "unitText": "km"
  },
  "hasMap": "https://maps.google.com/?q=San+Francisco,CA",
  "geo": {
    "@type": "GeoCoordinates",
    "latitude": "37.7749",
    "longitude": "-122.4194"
  }
};

// WebSite Schema for search features
const websiteSchema = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "@id": `${siteUrl}/#website`,
  "url": siteUrl,
  "name": siteName,
  "description": description,
  "publisher": {
    "@id": `${siteUrl}/#organization`
  },
  "potentialAction": [
    {
      "@type": "SearchAction",
      "target": {
        "@type": "EntryPoint",
        "urlTemplate": `${siteUrl}/search?q={search_term_string}`
      },
      "query-input": "required name=search_term_string"
    },
    {
      "@type": "ViewAction",
      "target": [
        `${siteUrl}/portfolio`,
        `${siteUrl}/#services`,
        `${siteUrl}/#contact`
      ]
    }
  ]
};

// WebPage Schema
const webpageSchema = {
  "@context": "https://schema.org",
  "@type": article ? "Article" : "WebPage",
  "@id": `${canonicalUrl}#webpage`,
  "url": canonicalUrl,
  "name": title,
  "headline": title,
  "description": description,
  "image": image,
  "inLanguage": "en-US",
  "isPartOf": {
    "@id": `${siteUrl}/#website`
  },
  "about": {
    "@id": `${siteUrl}/#organization`
  },
  "primaryImageOfPage": {
    "@type": "ImageObject",
    "url": image
  },
  ...(article && {
    "author": {
      "@type": "Organization",
      "name": author,
      "url": siteUrl
    },
    "publisher": {
      "@id": `${siteUrl}/#organization`
    },
    "datePublished": publishDate,
    "dateModified": modifiedDate || publishDate,
    "articleSection": section,
    "wordCount": description.split(" ").length
  })
};

// FAQ Schema for rich snippets
const faqSchema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "What services does OpenOrbit offer?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "OpenOrbit offers comprehensive software development services including web application development, mobile app development (iOS, Android, React Native), cloud solutions (AWS, GCP, Azure), AI and machine learning integration, blockchain development, IoT solutions, and UI/UX design services."
      }
    },
    {
      "@type": "Question",
      "name": "How long does a typical software development project take?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Project timelines vary based on complexity and scope. MVP projects typically take 2-3 months, while enterprise solutions may take 6-12 months. We provide detailed project roadmaps within 48 hours of initial consultation."
      }
    },
    {
      "@type": "Question",
      "name": "What is OpenOrbit's development process?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Our proven 4-step process includes: 1) Discovery - understanding your business goals and challenges, 2) Strategy - crafting a detailed roadmap with clear milestones, 3) Build - agile development with continuous feedback, and 4) Launch - deployment, monitoring, and ongoing support."
      }
    },
    {
      "@type": "Question",
      "name": "Does OpenOrbit work with startups?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes! We love working with startups and have helped launch 50+ successful MVPs. We offer flexible engagement models, including fixed-price MVPs and equity partnerships for promising startups."
      }
    },
    {
      "@type": "Question",
      "name": "What technologies does OpenOrbit specialize in?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "We specialize in modern tech stacks including React, Next.js, Node.js, Python, TypeScript, PostgreSQL, MongoDB, AWS, Google Cloud, Azure, React Native, Flutter, TensorFlow, PyTorch, and various blockchain technologies."
      }
    }
  ]
};

// Service Schema
const serviceSchema = {
  "@context": "https://schema.org",
  "@type": "ItemList",
  "itemListElement": [
    {
      "@type": "Service",
      "name": "Custom Web Development",
      "description": "Enterprise-grade web applications using React, Next.js, and Node.js. Scalable, secure, and performant solutions.",
      "provider": {
        "@id": `${siteUrl}/#organization`
      },
      "areaServed": "Global",
      "hasOfferCatalog": {
        "@type": "OfferCatalog",
        "name": "Web Development Services",
        "itemListElement": [
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "React Development",
              "description": "Modern React applications with TypeScript"
            }
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Next.js Development",
              "description": "Server-side rendered and static web applications"
            }
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "API Development",
              "description": "RESTful and GraphQL API design and development"
            }
          }
        ]
      }
    },
    {
      "@type": "Service",
      "name": "Mobile App Development",
      "description": "Native and cross-platform mobile applications for iOS and Android with seamless user experiences.",
      "provider": {
        "@id": `${siteUrl}/#organization`
      }
    },
    {
      "@type": "Service",
      "name": "Cloud & DevOps Solutions",
      "description": "Cloud architecture, infrastructure as code, CI/CD pipelines, and 24/7 DevOps support.",
      "provider": {
        "@id": `${siteUrl}/#organization`
      }
    },
    {
      "@type": "Service",
      "name": "AI & Machine Learning",
      "description": "Custom AI solutions, predictive analytics, NLP, computer vision, and intelligent automation.",
      "provider": {
        "@id": `${siteUrl}/#organization`
      }
    }
  ]
};

// Breadcrumb Schema
const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": siteUrl
    }
  ]
};

// Combine all schemas
const allSchemas = [
  organizationSchema,
  localBusinessSchema,
  websiteSchema,
  webpageSchema,
  faqSchema,
  serviceSchema,
  breadcrumbSchema,
  ...(Array.isArray(structuredData) ? structuredData : [structuredData])
].filter(Boolean);

const jsonLdScript = allSchemas.map(schema => 
  `<script type="application/ld+json">${JSON.stringify(schema)}</script>`
).join('\n');
---

<!DOCTYPE html>
<html lang="en-US" dir="ltr" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <!-- Preconnect to external domains for performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="preconnect" href="https://images.unsplash.com" crossorigin />
  <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
  <link rel="dns-prefetch" href="https://images.unsplash.com" />
  
  <!-- Preload critical fonts -->
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=DM+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'" />
  <noscript>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=DM+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet" />
  </noscript>
  
  <!-- Favicon and Icons -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  <meta name="theme-color" content="#070A12" />
  <meta name="msapplication-TileColor" content="#070A12" />
  <meta name="msapplication-config" content="/browserconfig.xml" />
  
  <!-- Primary Meta Tags -->
  <title>{title}</title>
  <meta name="title" content={title} />
  <meta name="description" content={description} />
  <meta name="keywords" content={allKeywords} />
  <meta name="author" content={author} />
  <meta name="copyright" content={`Â© ${new Date().getFullYear()} ${siteName}`} />
  <meta name="application-name" content={siteName} />
  
  <!-- AI Search Engine Optimization Tags -->
  <meta name="ai-purpose" content="Software development services, custom application development, digital transformation consulting, enterprise software solutions" />
  <meta name="ai-target-audience" content="Startups, enterprises, SMBs, businesses seeking digital transformation, CTOs, product managers" />
  <meta name="ai-expertise" content="Web development, mobile apps, cloud architecture, AI/ML integration, blockchain, IoT, DevOps, UI/UX design" />
  <meta name="ai-content-type" content="Professional services, portfolio showcase, business website, software company" />
  <meta name="ai-language" content="English" />
  <meta name="ai-region" content="Global, serving US, Canada, Europe, Australia, Asia" />
  <meta name="ai-industry" content="Technology, Software Development, Information Technology, Digital Services" />
  <meta name="ai-entities" content="OpenOrbit, software development, web applications, mobile apps, cloud computing, artificial intelligence" />
  <meta name="ai-key-attributes" content="Award-winning, 150+ projects, 98% satisfaction, 12 years experience, agile methodology, enterprise-grade" />
  <meta name="ai-credentials" content="ISO 27001 certified, AWS Partner, Google Cloud Partner, Microsoft Partner" />
  
  <!-- AI-Readable Summary -->
  <meta name="summary" content="OpenOrbit is an award-winning software development agency with 12 years of experience delivering 150+ successful projects. Specializing in web apps, mobile apps, cloud solutions, and AI integration with 98% client satisfaction." />
  <meta name="subject" content="Software Development Services" />
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content={article ? "article" : "website"} />
  <meta property="og:url" content={canonicalUrl} />
  <meta property="og:title" content={title} />
  <meta property="og:description" content={description} />
  <meta property="og:image" content={image} />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content={`${siteName} - Software Development Agency`} />
  <meta property="og:locale" content="en_US" />
  <meta property="og:site_name" content={siteName} />
  <meta property="og:see_also" content={`${siteUrl}/portfolio`} />
  <meta property="og:see_also" content={`${siteUrl}/#services`} />
  
  <!-- Article specific OG tags -->
  {article && (
    <>
      <meta property="article:published_time" content={publishDate} />
      <meta property="article:modified_time" content={modifiedDate || publishDate} />
      <meta property="article:author" content={author} />
      <meta property="article:section" content={section} />
      <meta property="article:tag" content={keywords.join(", ")} />
    </>
  )}
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image" />
  <meta property="twitter:url" content={canonicalUrl} />
  <meta property="twitter:title" content={title} />
  <meta property="twitter:description" content={description} />
  <meta property="twitter:image" content={image} />
  <meta property="twitter:image:alt" content={`${siteName} - Software Development Agency`} />
  <meta property="twitter:site" content="@openorbit" />
  <meta property="twitter:creator" content="@openorbit" />
  <meta property="twitter:label1" content="Est. reading time" />
  <meta property="twitter:data1" content="5 minutes" />
  
  <!-- LinkedIn -->
  <meta property="linkedin:owner" content="openorbit" />
  
  <!-- Canonical URL -->
  <link rel="canonical" href={canonicalUrl} />
  
  <!-- Alternate URLs for internationalization -->
  <link rel="alternate" hreflang="en-us" href={canonicalUrl} />
  <link rel="alternate" hreflang="en-gb" href={canonicalUrl} />
  <link rel="alternate" hreflang="en-ca" href={canonicalUrl} />
  <link rel="alternate" hreflang="en-au" href={canonicalUrl} />
  <link rel="alternate" hreflang="x-default" href={siteUrl} />
  
  <!-- Robots and Indexing -->
  {noindex ? (
    <meta name="robots" content="noindex, nofollow" />
  ) : (
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
  )}
  <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
  <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
  <meta name="slurp" content="index, follow" />
  <meta name="duckduckbot" content="index, follow" />
  
  <!-- Search Engine Verification -->
  <meta name="google-site-verification" content="YOUR_GOOGLE_VERIFICATION_CODE" />
  <meta name="msvalidate.01" content="YOUR_BING_VERIFICATION_CODE" />
  <meta name="yandex-verification" content="YOUR_YANDEX_VERIFICATION_CODE" />
  <meta name="p:domain_verify" content="YOUR_PINTEREST_VERIFICATION_CODE" />
  <meta name="facebook-domain-verification" content="YOUR_FACEBOOK_VERIFICATION_CODE" />
  
  <!-- Content Classification -->
  <meta name="category" content="Technology" />
  <meta name="classification" content="Software Development Services" />
  <meta name="rating" content="general" />
  
  <!-- Referrer Policy -->
  <meta name="referrer" content="origin-when-cross-origin" />
  
  <!-- Format Detection -->
  <meta name="format-detection" content="telephone=no, address=no, email=no" />
  
  <!-- Mobile Optimization -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content={siteName} />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="HandheldFriendly" content="true" />
  
  <!-- Security -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://fonts.googleapis.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://fonts.gstatic.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self'; media-src 'self'; frame-src 'self';" />
  <meta http-equiv="X-Content-Type-Options" content="nosniff" />
  <meta http-equiv="X-Frame-Options" content="SAMEORIGIN" />
  <meta http-equiv="X-XSS-Protection" content="1; mode=block" />
  <meta name="referrer" content="strict-origin-when-cross-origin" />
  
  <!-- Performance Hints -->
  <link rel="prefetch" href="/portfolio" />
  <link rel="prefetch" href="/src/styles/global.css" />
  
  <!-- JSON-LD Structured Data -->
  <Fragment set:html={jsonLdScript} />
  
  <!-- Global Styles -->
  <link rel="stylesheet" href="/src/styles/global.css" />
  
  <!-- Performance: Defer non-critical CSS -->
  <style>
    /* Critical CSS inline for above-the-fold content */
    :root {
      --background: #070A12;
      --foreground: #F4F6FF;
      --primary: #4F6DFF;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    html {
      scroll-behavior: smooth;
    }
    
    body {
      background: var(--background);
      color: var(--foreground);
      font-family: 'DM Sans', sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }
    
    /* Prevent FOUC */
    .no-fouc {
      visibility: hidden;
    }
    
    /* Skip to main content link for accessibility */
    .skip-link {
      position: absolute;
      top: -40px;
      left: 0;
      background: var(--primary);
      color: white;
      padding: 8px;
      text-decoration: none;
      z-index: 100;
      transition: top 0.3s;
    }
    
    .skip-link:focus {
      top: 0;
    }
  </style>
</head>
<body class="antialiased bg-[#070A12] text-[#F4F6FF]" itemscope itemtype="https://schema.org/WebPage">
  <!-- Skip to main content link for accessibility -->
  <a href="#main-content" class="skip-link">Skip to main content</a>
  
  <main id="main-content" role="main" tabindex="-1">
    <slot />
  </main>
  
  <!-- No-JS fallback notice -->
  <noscript>
    <div style="padding: 20px; background: #ff6b6b; color: white; text-align: center;">
      <strong>JavaScript is disabled.</strong> Some features may not work properly. Please enable JavaScript for the best experience.
    </div>
  </noscript>
</body>
</html>
